---
title: "Educational Data Analysis"
author: "Osvaldo Martins Quintella Junior"
date: "Last edited `r format(Sys.time(), '%d %B %Y')`"
output:
  html_document:
    df_print: paged
email_adress: osvaldoquintellajr@gmail.com
github_repo: https://github.com/osvaldoquintellajr/educational_data_analysis
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(fig.align = 'center')
options(scipen=999)
```

## **Exploratory Data Analysis of Censo Escolar**

The following code load the necessary packages.

```{r loading packages , include = TRUE, warning=FALSE, message=FALSE}
library(tidyverse)
library(ggthemes)
library(infer)
```

The following code read the data from my computer. But I saved all the data on a .RData file. This file is uploaded to github so everyone can download it and check the code by yourself.

```{r read data from the computer , include = TRUE, message=FALSE, warning=FALSE}
read.data <- function(year, file, variables){
  censo.escolar.year <- read_delim(file, 
                                 delim = ';',
                                 locale = locale(encoding = 'WINDOWS-1252'),
                                 escape_double = TRUE,
                                 trim_ws = TRUE,
                                 col_select = variables)}

variables <- c('NU_ANO_CENSO', 'NO_REGIAO', 'CO_REGIAO',
                                 'CO_UF', 'NO_MUNICIPIO', 'CO_ENTIDADE', 
                                 'TP_DEPENDENCIA', 'TP_LOCALIZACAO', 'TP_CATEGORIA_ESCOLA_PRIVADA',
                                 'TP_SITUACAO_FUNCIONAMENTO', 'IN_INTERNET',
                                 'IN_INTERNET_ALUNOS', 'IN_BANDA_LARGA', 
                                 'QT_MAT_BAS_D', 'QT_MAT_BAS_N', 'QT_MAT_BAS_EAD',
                                 'IN_FUND', 'IN_FUND_AI', 'IN_FUND_AF', 'IN_MED',
                                 'QT_MAT_FUND', 'QT_MAT_FUND_AI', 'QT_MAT_FUND_AF',
                                 'QT_MAT_MED', 'QT_MAT_EJA_MED', 'QT_MAT_FUND_INT', 
                                 'QT_MAT_FUND_AI_INT', 'QT_MAT_FUND_AF_INT', 
                                 'QT_MAT_MED_INT')

file.2022 <- '~/Documentos/microdados/censo escolar/microdados_ed_basica_2022/Dados/microdados_ed_basica_2022.csv'

file.2021 <- '~/Documentos/microdados/censo escolar/microdados_ed_basica_2021/Dados/microdados_ed_basica_2021.csv'

file.2020 <- '~/Documentos/microdados/censo escolar/microdados_ed_basica_2020/Dados/microdados_ed_basica_2020.csv'

file.2019 <- '~/Documentos/microdados/censo escolar/microdados_ed_basica_2019/Dados/microdados_ed_basica_2019.csv'
  
file.2018 <- '~/Documentos/microdados/censo escolar/microdados_ed_basica_2018/Dados/microdados_ed_basica_2018.csv'
  
file.2017 <- '~/Documentos/microdados/censo escolar/microdados_ed_basica_2017/Dados/microdados_ed_basica_2017.csv'
  
file.2016 <- '~/Documentos/microdados/censo escolar/microdados_ed_basica_2016/Dados/microdados_ed_basica_2016.csv'
  
file.2015 <- '~/Documentos/microdados/censo escolar/microdados_ed_basica_2015/Dados/microdados_ed_basica_2015.csv'
  
file.2014 <- '~/Documentos/microdados/censo escolar/microdados_ed_basica_2014/Dados/microdados_ed_basica_2014.csv'
  
file.2013 <- '~/Documentos/microdados/censo escolar/microdados_ed_basica_2013/Dados/microdados_ed_basica_2013.csv'
  
file.2012 <- '~/Documentos/microdados/censo escolar/microdados_ed_basica_2012/Dados/microdados_ed_basica_2012.csv'
  
file.2011 <- '~/Documentos/microdados/censo escolar/microdados_ed_basica_2011/Dados/microdados_ed_basica_2011.csv'
  
file.2010 <- '~/Documentos/microdados/censo escolar/microdados_ed_basica_2010/Dados/microdados_ed_basica_2010.csv'
  
censo.escolar.2022 <- read.data(2022, file.2022, variables)

censo.escolar.2021 <- read.data(2021, file.2021, variables)

censo.escolar.2020 <- read.data(2020, file.2020, variables)

censo.escolar.2019 <- read.data(2019, file.2019, variables)

censo.escolar.2018 <- read.data(2018, file.2018, variables)

censo.escolar.2017 <- read.data(2017, file.2017, variables)

censo.escolar.2016 <- read.data(2016, file.2016, variables)

censo.escolar.2015 <- read.data(2015, file.2015, variables)

censo.escolar.2014 <- read.data(2014, file.2014, variables)

censo.escolar.2013 <- read.data(2013, file.2013, variables)

censo.escolar.2012 <- read.data(2012, file.2012, variables)

censo.escolar.2011 <- read.data(2011, file.2011, variables)

censo.escolar.2010 <- read.data(2010, file.2010, variables)
```

Now, let's bind all this data.frame in only one data.frame called `censo.escolar`.

I've saved the data as censo_escolar.Rdata. This file is available on my repo: [repo](https://github.com/osvaldoquintellajr/education_data_analysis)

To read the censo_escolar.Rdata, you can use the following code: \> load("paste_the_file_directory_here")


```{r bind data.frames, echo=FALSE}
censo.escolar <- rbind(censo.escolar.2010, censo.escolar.2011, censo.escolar.2012, censo.escolar.2013, censo.escolar.2014, censo.escolar.2015, censo.escolar.2016, censo.escolar.2017, censo.escolar.2018, censo.escolar.2019, censo.escolar.2020, censo.escolar.2021, censo.escolar.2022)

censo.escolar
```

```{r remove objects, include=FALSE }
rm(censo.escolar.2010, censo.escolar.2011, censo.escolar.2012, censo.escolar.2013, censo.escolar.2014,  censo.escolar.2015, censo.escolar.2016, censo.escolar.2017, censo.escolar.2018, censo.escolar.2019, censo.escolar.2020, censo.escolar.2021, censo.escolar.2022)

rm(file.2010, file.2011, file.2012, file.2013, file.2014, file.2015, file.2016, file.2017, file.2018, file.2019, file.2020, file.2021,file.2022)
```

Let's visualize the first lines of the data frame.

```{r visualização das primeiras linhas do data frame censoescolar, echo=FALSE}
head(censo.escolar, 7)
```


To make data analysis easier, it is good practice to rename the variables. Let's do it.

```{r rename variables, echo=FALSE}
censo.escolar <-censo.escolar %>%
  rename(
    'Ano' = 'NU_ANO_CENSO', 
    'Nome_região_geográfica' = 'NO_REGIAO', 
    'Código_região_geográfica' = 'CO_REGIAO',
    'Código_UF' = 'CO_UF', 
    'Nome_Município' = 'NO_MUNICIPIO', 
    'Código_Escola' = 'CO_ENTIDADE', 
    'Dependência_Administrativa' = 'TP_DEPENDENCIA', 
    'Categoria_escola_privada' = 'TP_CATEGORIA_ESCOLA_PRIVADA',
    'Localização' = 'TP_LOCALIZACAO', 
    'Situação_funcionamento' = 'TP_SITUACAO_FUNCIONAMENTO', 
    'Acesso_Internet'= 'IN_INTERNET',
    'Acesso_Internet_alunos' = 'IN_INTERNET_ALUNOS', 
    'Internet_Banda_Larga' = 'IN_BANDA_LARGA', 
    'Número_Matrículas_Educação_Básica_Diurno' = 'QT_MAT_BAS_D', 
    'Número_Matrículas_Educação_Básica_Noturno' = 'QT_MAT_BAS_N', 
    'Número_Matrículas_Educação_Básica_Distância' = 'QT_MAT_BAS_EAD',
    'Ensino_Fundamental_Possui_matrículas' = 'IN_FUND', 
    'Ensino_Fundamental_Anos_Iniciais_Possui_matrículas' = 'IN_FUND_AI', 
    'Ensino_Fundamental_Anos_Finais_Possui_matrículas' = 'IN_FUND_AF', 
    'Ensino_Médio_Possui_matrículas' = 'IN_MED',
    'Número_Matrículas_Ensino_Fundamental' = 'QT_MAT_FUND', 
    'Número_Matrículas_Ensino_Fundamental_Anos_Iniciais' = 'QT_MAT_FUND_AI', 
    'Número_Matrículas_Ensino_Fundamental_Anos_Finais' = 'QT_MAT_FUND_AF',
    'Número_Matrículas_Ensino_Médio' = 'QT_MAT_MED',
    'Número_Matrículas_Ensino_Médio_EJA' = 'QT_MAT_EJA_MED',
    'Número_Matrículas_Ensino_Fundamental_integral' = 'QT_MAT_FUND_INT', 
    'Número_Matrículas_Ensino_Fundamental_Anos_Iniciais_integral' = 'QT_MAT_FUND_AI_INT',
    'Número_Matrículas_Ensino_Fundamental_Anos_Finais_integral' = 'QT_MAT_FUND_AF_INT',
    'Número_Matrículas_Ensino_Médio_Integral' = 'QT_MAT_MED_INT'
    )

head(censo.escolar, n = 6)
```

Before analyse the data is interesting to look at the format of all variables.
It is possible to see that there is 3.017.633 rows and 40 columns.

```{r cheking the structure of the data_1, echo=FALSE}
glimpse(censo.escolar)
```

-   A lot of variables are formatted as double. But the following variables:
    -   Dependência_Administrativa;
    -   Situação_funcionamento;
    -   Computadores_em_uso_pelos_alunos_desktop;
    -   and others. should all be formatted as categorical variables.

Let's change the format of variables that should be factors. In R, factors are used to work with categorical variables. 

```{r formating categorical variables, include=FALSE}
censo.escolar <- censo.escolar %>% mutate(
  Nome_região_geográfica = as_factor(if_else(Nome_região_geográfica == 'Norte', 'Norte', 
                                             if_else(Nome_região_geográfica == 'Sul', 'Sul', 
                                                     if_else(Nome_região_geográfica == 'Sudeste', 'Sudeste', 
                                                             if_else(Nome_região_geográfica == 'Nordeste', 'Nordeste', 
                                                                     if_else(Nome_região_geográfica == 'Centro_Oeste', 'Centro_Oeste', NA)))))),
  Dependência_Administrativa = as_factor(if_else(Dependência_Administrativa == 1, 'Federal', 
                                                 if_else(Dependência_Administrativa == 2, 'Estadual', 
                                                         if_else(Dependência_Administrativa == 3, 'Municipal', 
                                                                 if_else(Dependência_Administrativa == 4, 'Privada', NA))))),
  Categoria_escola_privada = as_factor(if_else(Categoria_escola_privada == 1, 'Particular', 
                                               if_else(Categoria_escola_privada == 2, 'Comunitária', 
                                                       if_else(Categoria_escola_privada == 3, 'Confessional', 
                                                               if_else(Categoria_escola_privada == 4, 'Filantrópica', NA))))),
  Localização = as_factor(if_else(Localização == 1, 'Urbana', 
                                  if_else(Localização == 2, 'Rural', NA))),
  Situação_funcionamento = as_factor(if_else(Situação_funcionamento == 1, 'Em_atividade', 
                                             if_else(Situação_funcionamento == 2, 'Paralisada', 
                                                     if_else(Situação_funcionamento == 3, 'Extinta', 
                                                             if_else(Situação_funcionamento == 4, 'Extinta_em_anos_anteriores', NA))))),
  Acesso_Internet = as_factor(if_else(Acesso_Internet == 1, 'Sim', 
                                      if_else(Acesso_Internet == 0, 'Não', NA))),
  Acesso_Internet_alunos = as_factor(if_else(Acesso_Internet_alunos == 1, 'Sim',  
                                             if_else(Acesso_Internet_alunos == 0, 'Não', NA))),
  Internet_Banda_Larga = as_factor(if_else(Internet_Banda_Larga == 1, 'Sim', 
                                           if_else(Internet_Banda_Larga == 0,  'Não', NA))),
  Ensino_Fundamental_Possui_matrículas = as_factor(if_else(Ensino_Fundamental_Possui_matrículas == 1, 'Sim', 
                                                           if_else(Ensino_Fundamental_Possui_matrículas == 0, 'Não', NA))),
  Ensino_Fundamental_Anos_Iniciais_Possui_matrículas = as_factor(if_else(Ensino_Fundamental_Anos_Iniciais_Possui_matrículas == 1, 'Sim', 
                                                                         if_else(Ensino_Fundamental_Anos_Iniciais_Possui_matrículas == 0, 'Não', NA))),
  Ensino_Fundamental_Anos_Finais_Possui_matrículas = as_factor(if_else(Ensino_Fundamental_Anos_Finais_Possui_matrículas == 1, 'Sim', 
                                                                       if_else(Ensino_Fundamental_Anos_Finais_Possui_matrículas == 0, 'Não', NA))),
  Ensino_Médio_Possui_matrículas = as_factor(if_else(Ensino_Médio_Possui_matrículas == 1, 'Sim', 
                                                     if_else(Ensino_Médio_Possui_matrículas == 0, 'Não', NA))))

```

Now, it is possible to see that we have the correct format of categorical variables.

```{r cheking the structure of the data_2, echo=FALSE}
glimpse(censo.escolar)
```

#### **Number of school enrollment at basic education.**


After formatting the variables, let's make some exploratory data analysis.
First, let's take a look at the number of school enrollment at basic education.

```{r número de matrículas por ano, echo=FALSE , message=FALSE, warning=FALSE}
censo.escolar  %>% 
  group_by(Ano)  %>%
  summarize('Número de matrículas no Ensino Fundamental' = sum(Número_Matrículas_Ensino_Fundamental, na.rm = TRUE), 
            'Número de matrículas no Ensino Fundamental_Anos Iniciais' = sum(Número_Matrículas_Ensino_Fundamental_Anos_Iniciais, na.rm = TRUE), 
            'Número de matrículas no Ensino Fundamental_Anos Finais' = sum(Número_Matrículas_Ensino_Fundamental_Anos_Finais, na.rm = TRUE), 
            'Número de matrículas no Ensino Médio' = sum(Número_Matrículas_Ensino_Médio, na.rm = TRUE)) 
```

Let's use a graph to better visualize this data.

```{r gráfico número de matrículas por ano, echo=FALSE , message=FALSE, warning=FALSE}
censo.escolar  %>% 
  group_by(Ano) %>% 
  summarize('Ensino_Fundamental' = sum(Número_Matrículas_Ensino_Fundamental, na.rm = TRUE), 
            'Ensino_Fundamental_Anos_Iniciais' = sum(Número_Matrículas_Ensino_Fundamental_Anos_Iniciais, na.rm = TRUE), 
            'Ensino_Fundamental_Anos_Finais' = sum(Número_Matrículas_Ensino_Fundamental_Anos_Finais, na.rm = TRUE), 
            'Ensino_Médio' = sum(Número_Matrículas_Ensino_Médio, na.rm = TRUE)) %>%
  pivot_longer("Ensino_Fundamental":"Ensino_Médio", names_to = "Nível de Ensino", values_to = "Quantidade_Matrículas") %>%
  ggplot(aes(x = Ano, y = Quantidade_Matrículas, color = `Nível de Ensino`)) + 
  geom_line() + 
  ggtitle("Quantidade de matrículas por nível de ensino") +
  theme_wsj() +
  theme(text = element_text(family = "serif"),
        axis.text = element_text(size = 11),
        axis.title.y = element_text("Quantidade de Matrículas", size = 11),
        axis.title.x = element_text("Ano", size = 11),
        axis.text.x = element_text(angle = 90),
        title = element_text(size = 11),
        legend.title = element_blank(),
        legend.text.position = "top" ) +
  scale_x_continuous(breaks = seq(from = 2010, to = 2022, by = 1)) +
  scale_y_continuous(breaks = seq(from = 4000000, to = 35000000, by = 4000000))
```

It is possible to conclude that the number of enrollment at basic education is falling. 

Now, the enrollment at basic education separated by location of school. 

```{r número de matrículas por ano e Localização, echo=FALSE, message=FALSE, warning=FALSE}
censo.escolar %>% group_by(Ano, Localização) %>% 
  summarize('Número de matrículas no Ensino Fundamental' = sum(Número_Matrículas_Ensino_Fundamental, na.rm = TRUE), 
            'Número de matrículas no Ensino Fundamental Anos Iniciais' = sum(Número_Matrículas_Ensino_Fundamental_Anos_Iniciais, na.rm = TRUE), 
            'Número de matrículas no Ensino Fundamental Anos Finais' = sum(Número_Matrículas_Ensino_Fundamental_Anos_Finais, na.rm = TRUE), 
            'Número de matrículas Ensino Médio' = sum(Número_Matrículas_Ensino_Médio, na.rm = TRUE)) %>% 
  pivot_wider(names_from = Localização, values_from = 'Número de matrículas no Ensino Fundamental':'Número de matrículas Ensino Médio')
```




```{r gráfico número de matrículas por ano e Localização_Ensino_Fundamental, echo=FALSE, message=FALSE, warning=FALSE}
censo.escolar %>% 
  filter(Situação_funcionamento != "Extinta") %>%
  ggplot(aes(x = Localização, color = Número_Matrículas_Ensino_Fundamental)) + 
  geom_bar() +
  facet_grid(~Ano) +
  theme_wsj() + 
  ggtitle("Quantidade de matrículas por localização_Ensino Fundamental") +
  theme(axis.text.x.bottom = element_text(angle = 90),
        text = element_text(family = 'serif', size = 11),
        axis.title.y = element_text("Quantidade de matrículas", size = 11 ),
        axis.title.x = element_text("Localização", size = 11),
        title = element_text(size = 9))
```

The graph above allows to conclude that the number of enrollments at elementary school
is falling at rural areas and is growing at urban areas.

The same happens to the number of enrollments at high school as we can see at the graph bellow.

```{r gráfico número de matrículas por ano e Localização_Ensino_Médio, echo=FALSE, message=FALSE, warning=FALSE}
censo.escolar %>% 
  filter(Situação_funcionamento != "Extinta") %>%
  ggplot(aes(x = Localização, color = Número_Matrículas_Ensino_Médio)) + 
  geom_bar() +
  facet_grid(~Ano) +
  theme_wsj() + 
  ggtitle("Quantidade de matrículas por localização_Ensino Médio") +
  theme(axis.text.x.bottom = element_text(angle = 90),
        text = element_text(family = 'serif', size = 11),
        axis.title.y = element_text("Quantidade de matrículas", size = 11 ),
        axis.title.x = element_text("Localização", size = 11),
        title = element_text(size = 9))
```


#### **Proportion of school with fast internet connection.**

Now, let's visualize a table of the proportion of school with fast internet connection.

```{r Porcentagem de escolas que têm acesso a internet,  echo=FALSE, warning=FALSE, message=FALSE}
censo.escolar %>% 
  group_by(Ano, Dependência_Administrativa) %>% 
  summarize('Proporção de escolas com acesso à internet' = mean(Internet_Banda_Larga == 'Sim')) 
```

Now, a graph to better visualization.

```{r proporção de escolas com conexão rápida com a internet por dependência administrativa, echo = FALSE, warning = FALSE}
censo.escolar %>%
filter(Situação_funcionamento != "Extinta") %>%
  ggplot(aes(x = Dependência_Administrativa, fill = Internet_Banda_Larga)) +
  geom_bar() +
  theme_wsj() +
  facet_grid(~Ano) + 
  ggtitle("Quantidade de escolas com internet banda larga") + 
  theme(axis.text.x.bottom = element_text(angle = 90, size = 7),
        title = element_text(size = 11),
        legend.title = element_blank())
``` 

The next table shows the proportion of schools with fast internet connection.  

```{r porcentagem de escolas com acesso a internet por localização da escola, echo=FALSE, message=FALSE, warning=FALSE}
censo.escolar %>% 
  group_by(Ano, Localização) %>% 
  summarize('Proporção de escolas com acesso à internet' = mean(Internet_Banda_Larga == 'Sim')) %>% 
  ungroup() %>% 
  pivot_wider(names_from = Localização, values_from = 'Proporção de escolas com acesso à internet') %>% 
  rename('Proporção de escolas com acesso à internet_Rural' = 'Rural', 'Proporção de escolas com acesso à internet_Urbana' = 'Urbana')
```

The graph bellow shows the proportion of schools with fast internet connection by location.

```{r gráfico da proporção de escolas com conexão banda larga, echo = FALSE, warning = FALSE}
censo.escolar %>% 
  group_by(Ano, Localização) %>% 
  summarize('Proporção_escolas_acesso_internet' = mean(Internet_Banda_Larga == 'Sim')) %>% 
  ungroup() %>% 
  ggplot(aes(x = Ano, y = Proporção_escolas_acesso_internet)) + 
  geom_ribbon(aes(ymax = Proporção_escolas_acesso_internet, ymin = 0,  color = Localização), alpha = 0.2) + 
  theme_wsj() + 
  ggtitle("Proporção de escolas com rede de internet banda larga") + 
  scale_x_continuous(limits = c(2010, 2021), breaks = seq(2010,2022,by =1)) +
  ylab("Proporção")+
  theme(text = element_text(family = 'serif', size =11),
        title = element_text(size = 11),
        legend.title = element_blank(),
        axis.title.x = element_text("Ano", size = 11),
        axis.title.y = element_text("Proporção", size = 11)) +
  geom_text(aes(label = round(Proporção_escolas_acesso_internet,2)), size = 3, color = 'black')
```

### **Exploratory Data Analysis of SAEB.**

Reading data from saeb.2021.5EF and saeb.2021.9EF and select the variables we are going to use.

```{r leitura dos microdados do SAEB_5EF, SAEB_9EF, SAEB_34EM, echo=FALSE, warning=FALSE, message=FALSE}

saeb.2021.5EF <- read_delim("~/Documentos/microdados/SAEB/microdados_saeb_2021_ensino_fundamental_e_medio/DADOS/TS_ALUNO_5EF.csv", 
                            delim = ";", escape_double = FALSE, trim_ws = TRUE) 

saeb.2021.5EF <- saeb.2021.5EF %>% select("ID_REGIAO", "ID_AREA", "IN_PUBLICA", 
                                          "ID_LOCALIZACAO", "PROFICIENCIA_LP_SAEB", 
                                          "PROFICIENCIA_MT_SAEB", "INSE_ALUNO",
                                          "NU_TIPO_NIVEL_INSE", "TX_RESP_Q01", 
                                          "TX_RESP_Q02", "TX_RESP_Q04", 
                                          "TX_RESP_Q07", "TX_RESP_Q08", "TX_RESP_Q18")

saeb.2021.9EF <- read_delim("/home/junior/Documentos/microdados/SAEB/microdados_saeb_2021_ensino_fundamental_e_medio/DADOS/TS_ALUNO_9EF.csv",
                            delim = ";", escape_double = FALSE, trim_ws = TRUE, show_col_types = FALSE)

saeb.2021.9EF <- saeb.2021.9EF %>% select("ID_REGIAO", "ID_AREA", "IN_PUBLICA", 
                                          "ID_LOCALIZACAO", "PROFICIENCIA_LP_SAEB", 
                                          "PROFICIENCIA_MT_SAEB", "INSE_ALUNO",
                                          "NU_TIPO_NIVEL_INSE", "TX_RESP_Q01", 
                                          "TX_RESP_Q02", "TX_RESP_Q04", 
                                          "TX_RESP_Q07", "TX_RESP_Q08", "TX_RESP_Q18")
```

Visualizing the first lines of both dataframes.

```{r visualização das primeiras linhas do dataframe saeb.2021.5EF, echo=FALSE}
head(saeb.2021.5EF, 7)
```


```{r visualização das primeiras linhas do dataframe saeb.2021.9EF, echo=FALSE}
head(saeb.2021.9EF, 7)

```

Now, it is important to get to know the dataframe. To do this let's use the glimpse function.

```{r conhecendo o data frame saeb.2021.5EF}
glimpse(saeb.2021.5EF)
``` 

```{r conhecendo o data frame saeb.2021.9EF} 
glimpse(saeb.2021.9EF)
``` 

A lot of variables are defined as Characters. Let's format this variables to factors.

```{r formatar variáveis categóricas para análise descritiva saeb.2021.5EF, echo=FALSE}
saeb.2021.5EF$ID_REGIAO <- factor(saeb.2021.5EF$ID_REGIAO,
                                  levels = c(1, 2, 3, 4, 5),
                                  labels = c("Norte", "Nordeste", "Sudeste", "Sul", "Centro-Oeste"))

saeb.2021.5EF$ID_AREA <- factor(saeb.2021.5EF$ID_AREA,
                                levels = c(1, 2),
                                labels = c("Capital", "Interior"))

saeb.2021.5EF$IN_PUBLICA <- factor(saeb.2021.5EF$IN_PUBLICA,
                                   levels = c(0, 1),
                                   labels = c("Privada", "Pública"))

saeb.2021.5EF$ID_LOCALIZACAO <- factor(saeb.2021.5EF$ID_LOCALIZACAO,
                                       levels = c(1, 2),
                                       labels = c("Urbana", "Rural"))

saeb.2021.5EF$TX_RESP_Q01 <- factor(saeb.2021.5EF$TX_RESP_Q01,
                                    levels = c('*', '.', 'A', 'B'),
                                    labels = c("Nulo", "Branco", "Masculino", "Feminino"))

saeb.2021.5EF$TX_RESP_Q02 <- factor(saeb.2021.5EF$TX_RESP_Q02,
                                    levels = c('*', '.', 'A', 'B', 'C', 'D', 'E', 'F'),
                                    labels = c('Nulo', 'Branco', '9 anos ou menos', '10 anos',
                                               '11 anos', '12 anos', '13 anos', '14 anos ou mais'))

saeb.2021.5EF$TX_RESP_Q04 <- factor(saeb.2021.5EF$TX_RESP_Q04,
                                    levels = c('*', '.', 'A', 'B', 'C', 'D', 'E', 'F'),
                                    labels = c('Nulo', 'Branco', 'Branca', 'Preta', 'Parda',
                                               'Amarela', 'Indígena', 'Não quero declarar'))

saeb.2021.5EF$TX_RESP_Q07 <- factor (saeb.2021.5EF$TX_RESP_Q07,
                                     levels = c ('*', '.', 'A', 'B', 'C', 'D', 'E', 'F'),
                                     labels = c('Nulo', 'Branco', 'Não completou o 5° ano do Ensino Fundamental',
                                                'Ensino Fundamental, até o 5° ano', 
                                                'Ensino Fundamental completo',
                                                'Ensino Médio completo',
                                                'Ensino Superior completo (faculdade ou graduação)',
                                                'Não sei'))

saeb.2021.5EF$TX_RESP_Q08 <- factor(saeb.2021.5EF$TX_RESP_Q08,
                                    levels = c ('*', '.', 'A', 'B', 'C', 'D', 'E', 'F'),
                                    labels = c('Nulo', 'Branco', 'Não completou o 5° ano do Ensino Fundamental',
                                               'Ensino Fundamental, até o 5° ano',
                                               'Ensino Fundamental completo',
                                               'Ensino Médio completo',
                                               'Ensino Superior completo (faculdade ou graduação)',
                                               'Não sei'))

saeb.2021.5EF$TX_RESP_Q18 <- factor(saeb.2021.5EF$TX_RESP_Q18,
                                    levels = c('*', '.', 'A', 'B', 'C'),
                                    labels = c('Nulo', 'Branco', 'Não',
                                               'Sim, uma vez',
                                               'Sim, duas vezes ou mais'))
```


```{r formatar variáveis categóricas para análise descritiva saeb.2021.9EF, echo=FALSE}
 saeb.2021.9EF$ID_REGIAO <- factor(saeb.2021.9EF$ID_REGIAO,
                                   levels = c (1, 2, 3, 4, 5),
                                   labels = c('Norte', 'Nordeste', 'Sudeste', 'Sul', 'Centro-Oeste'))

saeb.2021.9EF$ID_AREA <- factor(saeb.2021.9EF$ID_AREA,
                                levels = c (1, 2),
                                labels = c('Capital', 'Interior'))

saeb.2021.9EF$IN_PUBLICA <- factor(saeb.2021.9EF$IN_PUBLICA,
                                   levels = c (0, 1),
                                   labels = c('Privada', 'Pública'))

saeb.2021.9EF$ID_LOCALIZACAO <- factor(saeb.2021.9EF$ID_LOCALIZACAO,
                                       levels = c (1, 2),
                                       labels = c('Urbana', 'Rural'))

saeb.2021.9EF$TX_RESP_Q01 <- factor(saeb.2021.9EF$TX_RESP_Q01,
                                    levels = c ('*', '.', 'A', 'B'),
                                    labels = c('Nulo', 'Branco', 'Masculino', 'Feminino'))

saeb.2021.9EF$TX_RESP_Q02 <- factor(saeb.2021.9EF$TX_RESP_Q02,
                                    levels = c ('*', '.', 'A', 'B', 'C', 'D', 'E', 'F'),
                                    labels = c('Nulo', 'Branco', '13 anos ou menos',
                                               '14 anos', '15 anos', '16 anos',
                                               '17 anos', '18 anos ou mais'))

saeb.2021.9EF$TX_RESP_Q04 <- factor(saeb.2021.9EF$TX_RESP_Q04,
                                    levels = c ('*', '.', 'A', 'B', 'C', 'D', 'E', 'F'),
                                    labels = c('Nulo', 'Branco', 'Branca', 'Preta',
                                               'Parda', 'Amarela', 'Indígena',
                                               'Não quero declarar'))

saeb.2021.9EF$TX_RESP_Q07 <- factor(saeb.2021.9EF$TX_RESP_Q07,
                                    levels = c ('*', '.', 'A', 'B', 'C', 'D', 'E', 'F'),
                                    labels = c('Nulo', 'Branco', 'Não completou o 5° ano do Ensino Fundamental',
                                               'Ensino Fundamental, até o 5° ano',
                                               'Ensino Fundamental completo',
                                               'Ensino Médio completo',
                                               'Ensino Superior completo (faculdade ou graduação)',
                                               'Não sei'))

saeb.2021.9EF$TX_RESP_Q08 <- factor(saeb.2021.9EF$TX_RESP_Q08,
                                    levels = c ('*', '.', 'A', 'B', 'C', 'D', 'E', 'F'),
                                    labels = c('Nulo', 'Branco', 'Não completou o 5° ano do Ensino Fundamental',
                                               'Ensino Fundamental, até o 5° ano', 
                                               'Ensino Fundamental completo',
                                               'Ensino Médio completo',
                                               'Ensino Superior completo (faculdade ou graduação)',
                                               'Não sei'))

saeb.2021.9EF$TX_RESP_Q18 <- factor(saeb.2021.9EF$TX_RESP_Q18,
                                    levels = c ('*', '.', 'A', 'B', 'C'),
                                    labels = c('Nulo', 'Branco', 'Não', 
                                               'Sim, uma vez', 'Sim, duas vezes ou mais'))
```

```{r glimpse saeb.2021.5EF}
glimpse(saeb.2021.5EF)
```

```{r glimpse saeb.2021.9EF}
glimpse(saeb.2021.9EF)
```


Now, let's rename the variables.

```{r renomear variáveis, echo=FALSE}
saeb.2021.5EF <- saeb.2021.5EF %>%
  rename(
    "Região_Geográfica" = "ID_REGIAO",
    "Area" = "ID_AREA",
    "Rede_de_Ensino" = "IN_PUBLICA",
    "Localização" = "ID_LOCALIZACAO",
    "Sexo" = "TX_RESP_Q01",
    "Idade" = "TX_RESP_Q02",
    "Raça" = "TX_RESP_Q04",
    "Escolaridade_Mãe" = "TX_RESP_Q07",
    "Escolaridade_Pai" = "TX_RESP_Q08",
    "Já_foi_reprovado" = "TX_RESP_Q18")

saeb.2021.9EF <- saeb.2021.9EF %>%
  rename(
    "Região_Geográfica" = "ID_REGIAO",
    "Area" = "ID_AREA",
    "Rede_de_Ensino" = "IN_PUBLICA",
    "Localização" = "ID_LOCALIZACAO",
    "Sexo" = "TX_RESP_Q01",
    "Idade" = "TX_RESP_Q02",
    "Raça" = "TX_RESP_Q04",
    "Escolaridade_Mãe" = "TX_RESP_Q07",
    "Escolaridade_Pai" = "TX_RESP_Q08",
    "Já_foi_reprovado" = "TX_RESP_Q18")

```


#### **Mean and standard deviation of the achievement in math and portuguese.**

Let's get some descriptive statistics such as mean and standard deviation of the
achievement in math and portuguese. The results below are from students from the
fifth year of elementary school.


```{r estatísticas descritivas saeb.2021.5EF, echo=FALSE}
saeb.2021.5EF %>% 
  filter(Sexo %in% c("Masculino", "Feminino")) %>%
  group_by(Sexo) %>%
    summarize(Média_LP = mean(PROFICIENCIA_LP_SAEB, na.rm = TRUE),
              Sd_LP = sd(PROFICIENCIA_LP_SAEB, na.rm = TRUE),
              Média_MT = mean(PROFICIENCIA_MT_SAEB, na.rm = TRUE),
              Sd_MT = sd(PROFICIENCIA_MT_SAEB, na.rm = TRUE))
```

Now, the results from the students from the ninth year of elementary school.

```{r estatísticas descritivas saeb.2021.9EF, echo=FALSE}
saeb.2021.9EF %>% 
  filter(Sexo %in% c("Masculino", "Feminino")) %>%
  group_by(Sexo) %>%
    summarize(Média_LP = mean(PROFICIENCIA_LP_SAEB, na.rm = TRUE),
              Sd_LP = sd(PROFICIENCIA_LP_SAEB, na.rm = TRUE),
              Média_MT = mean(PROFICIENCIA_MT_SAEB, na.rm = TRUE),
              Sd_MT = sd(PROFICIENCIA_MT_SAEB, na.rm = TRUE))
```

#### **The number of students by age.**


Let's count the number of students who do the test by age.
The results below are from the students of the fifth year of elementary school.

```{r idade dos estudantes 5° ano, echo=FALSE}
saeb.2021.5EF %>%
  filter(Idade %in% c("9 anos ou menos", "10 anos", "11 anos", "12 anos", "13 anos", " 14 anos ou mais")) %>%
  group_by(Idade) %>%
  summarize(count = n())
```

The results below are from the students of the ninth year of elementary school.

```{r idade dos estudantes 9° ano, echo=FALSE}
saeb.2021.9EF %>%
  filter(Idade %in% c("13 anos ou menos", "14 anos", "15 anos", "16 anos", "17 anos", " 18 anos ou mais")) %>%
  group_by(Idade) %>%
  summarize(count = n())
```

#### **How many sudents have been reproved?**

The results below are from the students of the fifth year of elementary school.

```{r alunos reprovados 5°ano, echo=FALSE}
saeb.2021.5EF%>%
  filter(Já_foi_reprovado %in% c("Não", "Sim, uma vez", "Sim, duas vezes ou mais")) %>%
  group_by(Já_foi_reprovado) %>%
  summarise(count = n())
```

The results from the students of the ninth year of elementary school.

```{r alunos reprovados 9° ano, echo=FALSE}
saeb.2021.9EF%>%
  filter(Já_foi_reprovado %in% c("Não", "Sim, uma vez", "Sim, duas vezes ou mais")) %>%
  group_by(Já_foi_reprovado) %>%
  summarise(count = n())
```

#### **Level of parent's education.**

The education economics literature shows the high correlation between parental 
education and student's performance. 
Let's get some descriptive data about parent's education. 
The results below are from the student's mother of the fifth year of elementary school.
  
```{r escolaridade mãe 5EF, echo=FALSE}
saeb.2021.5EF %>%
  filter(Escolaridade_Mãe %in% c("Não completou o 5° ano do Ensino Fundamental", 
                                 "Ensino Fundamental, até o 5° ano", "Ensino Fundamental completo	",
                                 "Ensino Médio completo", 
                                 "Ensino Superior completo (faculdade ou graduação)")) %>%
  group_by(Escolaridade_Mãe) %>%
  summarise(Count = n())
```

The results below are from the students' father of the fifth year of elementary school.
 
```{r escolaridade pai 5EF, echo=FALSE}
saeb.2021.5EF %>%
  filter(Escolaridade_Pai %in% c("Não completou o 5° ano do Ensino Fundamental", 
                                 "Ensino Fundamental, até o 5° ano", "Ensino Fundamental completo	",
                                 "Ensino Médio completo", 
                                 "Ensino Superior completo (faculdade ou graduação)")) %>%
  group_by(Escolaridade_Pai) %>%
  summarise(Count = n())
```


The results below are from the students' mother of the ninth year of elementary school.


```{r escolaridade mãe 9EF, echo=FALSE}
saeb.2021.9EF %>%
  filter(Escolaridade_Mãe %in% c("Não completou o 5° ano do Ensino Fundamental", 
                                 "Ensino Fundamental, até o 5° ano", "Ensino Fundamental completo	",
                                 "Ensino Médio completo", 
                                 "Ensino Superior completo (faculdade ou graduação)")) %>%
  group_by(Escolaridade_Mãe) %>%
  summarise(Count = n())
```

 The results below are from the students' father of the ninth year of elementary school.

```{r escolaridade pai 9EF, echo=FALSE}
saeb.2021.9EF %>%
  filter(Escolaridade_Pai %in% c("Não completou o 5° ano do Ensino Fundamental", 
                                 "Ensino Fundamental, até o 5° ano", "Ensino Fundamental completo	",
                                 "Ensino Médio completo", 
                                 "Ensino Superior completo (faculdade ou graduação)")) %>%
  group_by(Escolaridade_Pai) %>%
  summarise(Count = n())
```


#### **Probability distribution of student's achievement.**

The probability distribution of student's achievement in portuguese by sex. 
The results are from students of the fifth year of elementary school. 

```{r distribuição de probabilidade das notas de meninos e meninas do 5EF em português, echo=FALSE, warning=FALSE}
saeb.2021.5EF %>%
  filter(Sexo %in% c("Masculino", "Feminino")) %>%
  ggplot(aes(x = PROFICIENCIA_LP_SAEB, color = Sexo)) + 
  geom_density() +
  theme_wsj() +
  ggtitle("Distribuição de probabilidade da nota em língua portuguesa por sexo_5EF") +
  theme(title = element_text(family = 'serif', size = 11),
        legend.title = element_blank(),
        axis.title.x = element_text(size = 11))
```

The probability distribution of student's achievement in math by sex. The results are from 
students of the fifth year of elementary school. 

```{r distribuição de probabilidade das notas de meninos e meninas do 5EF em matemática, echo=FALSE, warning=FALSE}
saeb.2021.5EF %>%
  filter(Sexo %in% c("Masculino", "Feminino")) %>%
  ggplot(aes(x = PROFICIENCIA_MT_SAEB, color = Sexo)) + 
  geom_density() +
  theme_wsj() +
  ggtitle("Distribuição de probabilidade da nota em matemática por sexo_5EF") +
  theme(title = element_text(family = 'serif', size = 11),
        legend.title = element_blank(),
        axis.title.x = element_text(size = 11)) +
scale_y_continuous(limits = c(0,0.01))
```

The probability distribution of student's achievement in portuguese by sex. 
The results are from students of the ninth year of elementary school. 

```{r distribuição de probabilidade das notas de meninos e meninas do 9EF em português, echo=FALSE, warning=FALSE}
saeb.2021.9EF %>%
  filter(Sexo %in% c("Masculino", "Feminino")) %>%
  ggplot(aes(x = PROFICIENCIA_LP_SAEB, color = Sexo)) + 
  geom_density() +
  theme_wsj() +
  ggtitle("Distribuição de probabilidade da nota em língua portuguesa por sexo_9EF") +
  theme(title = element_text(family = 'serif', size = 11),
        legend.title = element_blank(),
        axis.title.x = element_text(size = 11))
```

The probability distribution of student's achievement in math by sex. The results are from 
students of the ninth year of elementary school. 

```{r distribuição de probabilidade das notas de meninos e meninas do 9EF em matemática, echo=FALSE, warning=FALSE}
saeb.2021.9EF %>%
  filter(Sexo %in% c("Masculino", "Feminino")) %>%
  ggplot(aes(x = PROFICIENCIA_MT_SAEB, color = Sexo)) + 
  geom_density() +
  theme_wsj() +
  ggtitle("Distribuição de probabilidade da nota em matemática por sexo_9EF") +
  theme(title = element_text(family = 'serif', size = 11),
        legend.title = element_blank(),
        axis.title.x = element_text(size = 11))
```


#### **Boxplot of student's achievement.**


```{r boxplot nota saeb 5EF língua portuguesa, echo=FALSE, warning=FALSE}
saeb.2021.5EF %>%
  filter(Sexo %in% c("Masculino", "Feminino")) %>%
  ggplot(aes(x = Sexo, y = PROFICIENCIA_LP_SAEB)) + 
  geom_boxplot() +
  theme_wsj() + 
  ggtitle("Boxplot nota em língua portuguesa dos alunos do quinto ano do ensino fundamental.") +
  theme(title = element_text(family = 'serif', size = 11)) + 
  scale_y_continuous(limits = c(0, 400))
```

```{r boxplot nota saeb 5EF matemática, echo=FALSE, warning=FALSE}
saeb.2021.5EF %>%
  filter(Sexo %in% c("Masculino", "Feminino")) %>%
  ggplot(aes(x = Sexo, y = PROFICIENCIA_MT_SAEB)) + 
  geom_boxplot() +
  theme_wsj() + 
  ggtitle("Boxplot da nota em matemática dos alunos do quinto ano do ensino fundamental.") +
  theme(title = element_text(family = 'serif', size = 11)) + 
  scale_y_continuous(limits = c(0, 400))
```
```{r boxplot nota saeb 9EF língua portuguesa, echo=FALSE, warning=FALSE}
saeb.2021.9EF %>%
  filter(Sexo %in% c("Masculino", "Feminino")) %>%
  ggplot(aes(x = Sexo, y = PROFICIENCIA_LP_SAEB)) + 
  geom_boxplot() +
  theme_wsj() + 
  ggtitle("Boxplot nota em língua portuguesa dos alunos do nono ano do ensino fundamental.") +
  theme(title = element_text(family = 'serif', size = 11)) + 
  scale_y_continuous(limits = c(0, 400))
```

```{r boxplot nota saeb 9EF matemática, echo=FALSE, warning=FALSE}
saeb.2021.9EF %>%
  filter(Sexo %in% c("Masculino", "Feminino")) %>%
  ggplot(aes(x = Sexo, y = PROFICIENCIA_MT_SAEB)) + 
  geom_boxplot() +
  theme_wsj() + 
  ggtitle("Boxplot nota em matemática dos alunos do nono ano do ensino fundamental.") +
  theme(title = element_text(family = 'serif', size = 11)) + 
  scale_y_continuous(limits = c(100, 400))
```

#### **Inferential analysis.**

Now, let's do some basic inferential analysis.

It there a statistical significant difference between 
